typeorm 에는 `cache` 메서드가 있다. (캐시 ID, 캐시 시간을 지정해줄 수 있음.)
이 메서드를 사용하면서 적절한 캐시 시간에 대하여 찾아보게 되었음.(https://www.stormit.cloud/blog/cache-hit-ratio-what-is-it/)

캐시는 데이터를 저장하고 이를 다시 재사용하는 메커니즘이다.
쿼리 결과를 캐시에 저장하면, 이후 동일한 요청이 발생할 때는 쿼리를 실행하지 않고 캐시된 데이터를 반환하여 서버 부하를 줄일 수 있다.
> ```typescript
> ~ createQueryBuilder().cache(id, 3000).getMany();
> ```

캐시 시간을 설정할 때는 몇 가지 고려해야 할 사항이 있다.
캐시 시간은 성능과 최신 데이터 간의 trade-off 관계에 있으므로, 시스템 요구 사항과 사용자 경험에 따라 다를 수 있다.
일반적으로 캐시 시간을 결정할 때 고려해야 할 요소는 다음과 같습니다.

1. 데이터 업데이트 빈도: 데이터가 얼마나 자주 업데이트되는지 고려해야 한다. 만약 데이터가 자주 변경된다면, 캐시 시간을 짧게 설정하여 최신 데이터를 보장할 수 있어야 한다. 그러나 작품 데이터가 자주 변경되지 않는다면, 캐시 시간을 더 길게 설정하여 데이터베이스 또는 다른 리소스에 대한 부하를 줄일 수 있다.

2. 사용자 경험 요구 사항: 사용자가 데이터를 불러오는 기능을 자주 접근하는 경우, 캐시 시간을 짧게 설정하여 실시간 업데이트된 결과를 제공하는 것이 좋다. 그렇지 않다면, 캐시 시간을 더 길게 설정하여 서버 응답 시간을 개선할 수 있다.

3. 시스템 성능: 캐시된 데이터의 크기와 서버 자원 등 시스템 성능에도 영향을 미친다. 캐시된 데이터가 많은 경우, 캐시 시간을 짧게 설정하면 서버의 메모리 사용량이 늘어나고, 캐시된 데이터를 로드하는 데 필요한 시간이 더 많이 소요될 수 있다. 따라서 시스템 자원과 성능을 고려하여 최적의 캐시 시간을 결정해야 한다.

4. 어플리케이션의 용도나 성격.

일반적으로 **5-10초** 정도의 캐시 시간은 실시간 업데이트를 필요로 하는 데이터에 대해 충분한 시간이다. 하지만 역시 실제 시나리오에 따라 조정될 수 있다.

---

하지만 조금 더 공학적으로 접근해보자면 캐시 히트 비율(cache hit ratio)로 시간을 조정하는 데 도움이 될 수 있다.
캐시 시간은 캐시에 데이터를 유지하는 기간을 의미하며, 일반적으로 캐시 시간이 길수록 캐시 히트 비율이 증가한다. (동일한 데이터에 대하여 반복적인 엑세스가 발생할 경우)

캐시 히트 비율을 모니터링하여 캐시 시간을 조정하는 방법은 다음과 같다.

1. 초기 설정: 초기에는 캐시 시간을 적절하게 설정해야 한다. 캐시 시간을 너무 짧게 설정하면 캐시 히트 비율이 낮아지고, 캐시 시간을 너무 길게 설정하면 캐시 히트 비율이 높아질 수 있지만 캐시 메모리의 용량을 초과할 수 있다. 초기 설정에서는 이러한 균형을 찾아야 한다.

2. 모니터링: 시스템이 작동하는 동안 캐시 히트 비율을 모니터링한다. 이를 통해 실제 애플리케이션의 데이터 액세스 패턴과 캐시의 효율성을 파악할 수 있다.

- 크롬 개발자 도구를 사용하여 캐시 히트 비율을 모니터링할 수 있다.
- 네트워크 탭에서 캐시 항목에 대하여 cache hit, cache miss 를 식별할 수 있다.

캐시 히트와 미스 식별: 요청 항목에서 "캐시 히트" 및 "캐시 미스"를 식별할 수 있습니다. "캐시 히트"는 캐시에서 데이터를 가져온 경우를 의미하고, "캐시 미스"는 캐시에서 데이터를 찾지 못하고 다른 곳에서 데이터를 가져온 경우를 의미합니다.

캐시 히트 비율 계산: 모니터링하는 동안 "캐시 히트"와 "캐시 미스"의 수를 세어서 캐시 히트 비율을 계산할 수 있습니다. 캐시 히트 비율은 캐시 히트의 수를 전체 요청 수로 나눈 값으로 계산됩니다.

3. 캐시 시간 조정: 캐시 히트 비율을 확인하고 캐시 시간을 조정한다. 캐시 히트 비율이 낮은 경우 캐시 시간을 늘려보고, 캐시 히트 비율이 높은 경우 캐시 시간을 줄여본다. 이 과정을 반복하면서 최적의 캐시 시간을 찾아갈 수 있다.

물론 어느 정도의 캐시 히트 적중률이 최적화된 캐시 시간인지는 분명하지 않다. 적중률이 0.95~0.99일 때 우수하다는 것은 캐시 시간과 별개이다.
결국 위와 같이 캐시 시간을 설정할 때는 몇 가지 고려해야 할 사항을 잘 살펴보는 게 중요하다.
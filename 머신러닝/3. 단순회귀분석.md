![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img.png)

어떤 변수**(독립 변수)**가 다른 변수**(종속 변수)**에 영향을 준다면 **두 변수 사이에 선형 관계가 있다**고 한다. 이와 같은 선형관계를 알고 싶다면 새로운 독립 변수값이 주어졌을 때 거기에 대응되는 종속 변수 값을 예측할 수 있다.

이처럼 두 변수 사이에 일대일로 대응되는 확률적, 통계적 상관성을 찾는 알고리즘을 단순회귀분석(simple linear regression)이라고 한다. 대표적인 **지도학습 유형**이다.

수학적으로는 종속 변수 Y와 독립 변수 X 사이의 관계를 **Y = aX + b** 로 나타낸다. 단순회귀 알고리즘은 **훈련 데이터를 이용하여 직선의 기울기(a)와 직선이 y축과 교차하는 지점인 y절편(b)을 반복 학습을 통해 찾는다**. 다시 말해 변수 X와 Y에 대한 정보를 가지고, 일차 방정식의 계수 a, b를 찾는 과정이 단순회귀분석 알고리즘이다.

------

### **STEP 1 데이터 준비**



![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img-16454191004762.png)



### **STEP 2 데이터 탐색**



![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img-16454191004773.png)

![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img-16454191004774.png)

: [391 rows x 9 columns]



### **STEP 3 속성 선택**

![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img-16454191004775.png)

**단순회귀분석에 변수로 사용할 후보 열을 선택한다. 예측 목표인 종속 변수(Y)가 될 'mpg' 열과 독립 변수(X)로 사용할 후보로 3개의 열('cylinders', 'horsepower', 'weight')을 포함한다.**

![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img-16454191004786.png)

3개의 후보 중에서 단순회귀분석에 사용할 독립 변수를 선택한다. 종속 변수(Y)와 독립 변수(X)간의 일대일 관계를 찾는 것이므로 두 변수 간에 선형관계가 있는지 그래프를 그려서 확인한다.

![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img-16454191004787.png)

pairplot() 함수를 사용하면 두 변수 간의 모든 경우의 수를 그릴 수 있다.



### **STEP 4 훈련/검증 데이터 분할**

![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img-16454191004788.png)

앞에서 그린 산점도에서 'mpg' 열과 선형관계를 보이는 'horsepower' 열과 'weight' 열을 독립 변수 X로 선택하는 것을 고려한다. 두 변수 간의 회귀방정식을 찾을 차례이다. 훈련 데이터와 검증 데이터로 나눠서 모형을 구축했다.



### **STEP 5 모형 학습 및 검증**

![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img-16454191004789.png)

회귀분석에서의 **결정계수**는 자료에 대한 추정된 모형의 적합도를 의미한다.

**결정계수가 1에 가까울 수록 모형이 자료를 잘 설명하고 있다고 할 수 있다.**



![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img-164541910047910.png)

회귀선의 관계식 즉, 회귀방정식을 구성하는 계수 a,b를 확인할 수 있다. **계수 a**는 **회귀식의 기울기**를 나타내고, 모형 객체 lr의 **coef_ 속성값**이다. **계수 b**는 **y 절편**이고, 모형 객체 lr의 **intercept_ 속성값**이다. 



![img](assets/3.%20%EB%8B%A8%EC%88%9C%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D/img-164541910047911.png)

모형이 예측한 결과와 실제 값을 비교했다. 독립 변수 전체 데이터(X)를 predict() 메소드에 입력하여 모형이 반환하는 예측값을 Y_hat에 저장한다. 실제 값 Y와 모형의 예측값 Y_hat을 같은 화면에 분포도를 그려서 비교한다. Seaborn 라이브러리의 distplot()함수를 사용한다.

출력된 결과를 보면 실제 값은 왼쪽으로 편향되어 있고 예측값은 오른쪽으로 편중되는 경향을 보인다. 따라서 독립 변수(weight)와 종속 변수(mpg) 사이에 선형관계가 있지만, 모형의 오차를 더 줄일 필요가 있어 보인다.